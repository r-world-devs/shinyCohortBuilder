(()=>{const e=[".vscomp-search-input"];Shiny.addCustomMessageHandler("show_alert",(function(e){alert(e.info)})),Shiny.addCustomMessageHandler("pre_add_step_action",(function(e){$("#"+e.ns_prefix+"cb_container").find("div.cb_step .cb_rm_step").prop("disabled",!0),$("#"+e.ns_prefix+"cb_panel").find(".cb_add_step").blur()})),Shiny.addCustomMessageHandler("post_rm_step_action",(function(e){$("#"+e.ns_prefix+"cb_container").find("div.cb_step:last-child:not(:first-child) .cb_rm_step").prop("disabled",!1)})),Shiny.addCustomMessageHandler("inform_data_updated",(function(e){Shiny.setInputValue(e.ns_prefix+"cb_data_updated",e,{priority:"event"})})),Shiny.addCustomMessageHandler("update_na_count",(function(e){var t,a,i;$filter=(t=e.step_id,a=e.filter_id,i=e.ns_prefix,$("#"+i+t+' div.cb_filter[data-filter_id="'+a+'"]')),$filter.find(".cb_na_value").html(e.na_count)})),Shiny.addCustomMessageHandler("up_state",(function(e){Shiny.setInputValue(e.ns_prefix+"action",e,{priority:"event"})})),Shiny.addCustomMessageHandler("update_filter_class",(function(e){var t="#"+e.ns_prefix+e.step_id,a=$(t).find('div.cb_filter[data-filter_id="'+e.filter_id+'"] .cb_filter_content');e.show?a.removeClass(e.class):a.addClass(e.class)})),Shiny.addCustomMessageHandler("enable_panel",(function(e){$("#"+e.ns_prefix+"cb_panel").addClass("disabled"),!0===e.enable&&$("#"+e.ns_prefix+"cb_panel").removeClass("disabled")})),Shiny.addCustomMessageHandler("update_class",(function(e){var t;"add"==e.action&&($("#"+e.ns_prefix+e.step_id).addClass(e.class),t=!1),"remove"==e.action&&($("#"+e.ns_prefix+e.step_id).removeClass(e.class),t=!0),e.hasOwnProperty("disable")&&$("#"+e.ns_prefix+e.step_id).find(e.disable).prop("disabled",t)}));var t={};$(document).on("shiny:inputchanged",(function(a){var i=a.target;if(i==document)return!0;if(Boolean(i.dataset.ignore)||$(i).is(e.join(",")))return!0;var n=i.closest(".cb_input");if(Boolean(n)){var s=n.closest(".cb_container").dataset.ns_prefix,d=n.closest(".cb_step")?.dataset?.step_id,r=n.closest(".cb_filter")?.dataset?.filter_id,_=Boolean("init"==n.dataset.exec_state),l=n.dataset.param,o=n.attributes.priority?.value;if("_update-mode_"==t[a.name]||_)t[a.name]=JSON.parse(JSON.stringify(a.value)),n.dataset.exec_state="active";else if(JSON.stringify(t[a.name])!=JSON.stringify(a.value)||"event"===o){var p=JSON.parse(JSON.stringify(a.value));t[a.name]=p,Shiny.setInputValue(s+"action",{id:"update_filter",params:{step_id:d,filter_id:r,input_value:p,input_name:l,binding:a.inputType,run_flow:!1}},{priority:"event"})}}})),$(document).on("shiny:updateinput",(function(e){Boolean(e.target.closest(".cb_input"))&&(t[e.target.id]="_update-mode_")}))})();